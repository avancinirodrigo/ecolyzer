<!DOCTYPE html>
<html lang="en">
    <head>
    	<meta charset="utf-8">
        <title>Souce Codes</title>
        <style type="text/css">
			.wrapper {
			    width:100%;
			    margin: 0 auto;
			}

			#to_source {
			    float:left;
			    width: 49%;
			    background-color: #EEE8AA;
			}

			#from_source
			{
			    float:right;
			    width: 49%;
			    background-color: #EEE8AA;
			    /*margin: 10% 10%;*/
			    /*padding: 20px;*/
			    /*width: 180px;*/
			}

			mark {
			  background: red;
			  color: black;
			}					      	
        </style>
		<script src="https://code.jquery.com/jquery-latest.min.js"></script>
		<script src="https://cdn.jsdelivr.net/mark.js/8.6.0/jquery.mark.min.js"></script>
    </head>
    <body>
		<div class="wrapper">

			<div id="to_source">
				<h2><span>{{ to_fullpath }}</span></h2>
				<p></p>
			</div>
			<div id="from_source">
				<h2><span>{{ from_fullpath }}</span></h2>
				<p></p>
			</div>
		</div>		                                    
    </body>
</html>
<script type="text/javascript">
	var to_source = {{ to_source|tojson }}
	var from_source = {{ from_source|tojson }}

	to_source = to_source.replace(/(\t)/g, "&nbsp;&nbsp;&nbsp;&nbsp;")
	//to_source = to_source.replace(/ /g, "&nbsp;") // TODO: review
	to_source = to_source.replace(/(\n)/g, "<br>")		

	from_source = from_source.replace(/(\t)/g, "&nbsp;&nbsp;&nbsp;&nbsp;")
	//from_source = from_source.replace(/ /g, "&nbsp;")
	from_source = from_source.replace(/(\n)/g, "<br>")	
	
	$("#to_source").find("p").html(to_source);
	$("#from_source").find("p").html(from_source);	

	var code_elements = {{ code_elements|safe }}

	for(var i = 0; i < code_elements.length; i++) {
		var from_regex = new RegExp("[:| ]" + code_elements[i] + "[(|{]");
		$("#from_source").find("p").markRegExp(from_regex);

		var to_regex1 = new RegExp(code_elements[i] + " = function");
		var to_regex2 = new RegExp("function " + code_elements[i]);
		$("#to_source").find("p").markRegExp(to_regex1);			
		$("#to_source").find("p").markRegExp(to_regex2);			
	}
</script>
